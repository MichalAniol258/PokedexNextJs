(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{2817:(e,t,a)=>{Promise.resolve().then(a.bind(a,6728))},6728:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(5155),l=a(5695),r=a(2115),o=a(3464),n=a(4414),c=a(6766);let i=e=>{let{setImage:t,error:a}=e,o=(0,r.useRef)(null),n=(0,l.usePathname)(),[i,u]=(0,r.useState)(null);console.log(i);let d=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({video:!0});o.current&&(o.current.srcObject=e)}catch(e){console.error("Error accessing the camera:",e)}};return(0,r.useEffect)(()=>{n.includes("/upload")&&d()},[n,a]),(0,s.jsxs)("div",{className:"absolute inset-0 flex items-center h-[825px] justify-center z-[1]",children:[(0,s.jsx)("video",{ref:o,autoPlay:!0,playsInline:!0,muted:!0,className:"w-[425px] kamera aspect-square rounded-full object-cover"}),(0,s.jsx)("div",{className:"absolute bottom-[0]",children:(0,s.jsx)(c.default,{src:"/capture.svg",width:50,height:50,alt:"",onClick:()=>{let e=o.current;if(e&&e.srcObject){let a=document.createElement("canvas");a.width=e.videoWidth,a.height=e.videoHeight;let s=a.getContext("2d");s&&(s.drawImage(e,0,0,a.width,a.height),u(a.toDataURL("image/png")),a.toBlob(e=>{e&&t(new File([e],"captured-photo.png",{type:"image/png"}))},"image/png"),e.srcObject.getTracks().forEach(e=>e.stop()))}},className:"min-w-[90px] kamera top-[4.4rem] relative  cursor-pointer"})})]})};function u(){let[e,t]=(0,r.useState)(null),[a,u]=(0,r.useState)(""),[d,p]=(0,r.useState)(),[m,h]=(0,r.useState)(!1),g=(0,l.useRouter)(),f=(0,l.usePathname)(),x=async()=>{if(!e)return;u(""),h(!0);let a=new FormData;a.append("image",e);try{let e=await o.A.post("/api/analyze",a,{headers:{"Content-Type":"multipart/form-data"}});console.log("res.data:",e.data),t(null),p(e.data.id)}catch(e){var s;console.log("Error uploading image:",e),u((null==e?void 0:null===(s=e.response)||void 0===s?void 0:s.data)||"Some error occured")}finally{h(!1)}};return f.includes("/upload")&&!m&&e&&!a&&x(),(0,r.useEffect)(()=>{!m&&e&&x()},[e]),(0,r.useEffect)(()=>{void 0!==d&&g.push("/pokemons/".concat(d))},[d]),(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(n.Z,{className:"max-w-lg mx-auto p-4 space-y-4 bg-white shadow-lg rounded-none min-h-[900px] z-auto  bg-[url('/camera-bg.jpg')] bg-cover bg-no-repeat",children:[(0,s.jsx)(c.default,{src:"/header.png",width:50,height:50,alt:"",className:"absolute left-[0] top-[0] w-full",unoptimized:!0}),(0,s.jsx)("div",{className:"flex justify-center w-full h-[800px]",children:(0,s.jsx)(c.default,{src:"/captureNoBG.png",width:250,height:250,alt:"Image Description",className:"w-[700px]  object-contain opacity-80 z-[200]"})}),(0,s.jsx)(i,{error:a,setImage:e=>{t(e)}}),a&&(0,s.jsx)("p",{style:{zIndex:5,color:"red"},children:a}),(0,s.jsx)("div",{className:"w-full p-[6px] my-[0] absolute left-[0] bottom-[0]   h-[5.5rem]  flex justify-center  bg-violet-500"}),m&&(0,s.jsx)("p",{style:{zIndex:5},children:"Loading"})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[641,227,766,971,441,684,358],()=>t(2817)),_N_E=e.O()}]);
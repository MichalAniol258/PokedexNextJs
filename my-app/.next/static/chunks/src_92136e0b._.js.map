{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ramia/Documents/Projekty/PokedexNextJs/my-app/src/components/Camera/Camera.tsx"],"sourcesContent":["\"use client\";\n\nimport Image from \"next/image\";\nimport { usePathname } from \"next/navigation\";\nimport React, { useState, useRef, useEffect } from \"react\";\n\ninterface CameraComponentProps {\n    setImage: (image: File) => void;\n    error?: string\n}\n\nconst CameraComponent: React.FC<CameraComponentProps> = ({ setImage, error }) => {\n    const videoRef = useRef<HTMLVideoElement>(null);\n    const pathname = usePathname();\n    const [imageSrc, setImageSrc] = useState<string | null>(null);\n\n    // Start the camera\n    const startCamera = async () => {\n        try {\n            const stream = await navigator.mediaDevices.getUserMedia({\n                video: { facingMode: \"environment\" } // Ustawienie przedniej kamery\n            });\n            if (videoRef.current) {\n                videoRef.current.srcObject = stream;\n            }\n        } catch (error) {\n            console.error(\"Error accessing the camera:\", error);\n        }\n    };\n\n    useEffect(() => {\n        if (pathname.includes(\"/upload\")) {\n            startCamera()\n        }\n    }, [pathname, error])\n\n    // Capture a photo from the video stream\n    const capturePhoto = () => {\n        const video = videoRef.current;\n        if (video && video.srcObject) {\n            const canvas = document.createElement(\"canvas\");\n            canvas.width = video.videoWidth;\n            canvas.height = video.videoHeight;\n            const context = canvas.getContext(\"2d\");\n            if (context) {\n                context.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n                // Convert canvas to image URL for preview\n                const imageUrl = canvas.toDataURL(\"image/png\");\n                setImageSrc(imageUrl);\n\n                // Convert canvas to Blob and then to File\n                canvas.toBlob((blob) => {\n                    if (blob) {\n                        const file = new File([blob], \"captured-photo.png\", {\n                            type: \"image/png\",\n                        });\n                        setImage(file); // Pass the File object to the parent component\n                    }\n                }, \"image/png\");\n\n                // Stop the camera stream\n                const stream = video.srcObject as MediaStream;\n                const tracks = stream.getTracks();\n                tracks.forEach((track) => track.stop());\n            }\n        }\n    };\n\n    return (\n        <div className=\"absolute inset-0 flex items-center  justify-center z-[1]\">\n            <video\n                ref={videoRef}\n                width={250}\n                height={250}\n                autoPlay\n                playsInline\n                muted\n                className=\"w-[325px] aspect-square rounded-full object-cover z-10\"\n            ></video>\n\n\n            <div className=\"absolute bottom-[0]\">\n\n                <Image src={'/capture.svg'} width={50} height={50} alt=\"\" onClick={capturePhoto} className=\"min-w-[80px]  cursor-pointer\" />\n\n\n            </div>\n\n            {/* {imageSrc && (\n                <div>\n                    <h2>Captured Photo</h2>\n                    <img src={imageSrc} alt=\"Captured\" />\n                </div>\n            )}*/}\n        </div>\n    );\n};\n\nexport default CameraComponent;"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;;AAJA;;;;AAWA,MAAM,kBAAkD,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE;;IACxE,MAAM,WAAW,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAoB;IAC1C,MAAM,WAAW,CAAA,GAAA,qIAAA,CAAA,cAAW,AAAD;IAC3B,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAExD,mBAAmB;IACnB,MAAM,cAAc;QAChB,IAAI;YACA,MAAM,SAAS,MAAM,UAAU,YAAY,CAAC,YAAY,CAAC;gBACrD,OAAO;oBAAE,YAAY;gBAAc,EAAE,8BAA8B;YACvE;YACA,IAAI,SAAS,OAAO,EAAE;gBAClB,SAAS,OAAO,CAAC,SAAS,GAAG;YACjC;QACJ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,+BAA+B;QACjD;IACJ;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;qCAAE;YACN,IAAI,SAAS,QAAQ,CAAC,YAAY;gBAC9B;YACJ;QACJ;oCAAG;QAAC;QAAU;KAAM;IAEpB,wCAAwC;IACxC,MAAM,eAAe;QACjB,MAAM,QAAQ,SAAS,OAAO;QAC9B,IAAI,SAAS,MAAM,SAAS,EAAE;YAC1B,MAAM,SAAS,SAAS,aAAa,CAAC;YACtC,OAAO,KAAK,GAAG,MAAM,UAAU;YAC/B,OAAO,MAAM,GAAG,MAAM,WAAW;YACjC,MAAM,UAAU,OAAO,UAAU,CAAC;YAClC,IAAI,SAAS;gBACT,QAAQ,SAAS,CAAC,OAAO,GAAG,GAAG,OAAO,KAAK,EAAE,OAAO,MAAM;gBAE1D,0CAA0C;gBAC1C,MAAM,WAAW,OAAO,SAAS,CAAC;gBAClC,YAAY;gBAEZ,0CAA0C;gBAC1C,OAAO,MAAM,CAAC,CAAC;oBACX,IAAI,MAAM;wBACN,MAAM,OAAO,IAAI,KAAK;4BAAC;yBAAK,EAAE,sBAAsB;4BAChD,MAAM;wBACV;wBACA,SAAS,OAAO,+CAA+C;oBACnE;gBACJ,GAAG;gBAEH,yBAAyB;gBACzB,MAAM,SAAS,MAAM,SAAS;gBAC9B,MAAM,SAAS,OAAO,SAAS;gBAC/B,OAAO,OAAO,CAAC,CAAC,QAAU,MAAM,IAAI;YACxC;QACJ;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBACG,KAAK;gBACL,OAAO;gBACP,QAAQ;gBACR,QAAQ;gBACR,WAAW;gBACX,KAAK;gBACL,WAAU;;;;;;0BAId,6LAAC;gBAAI,WAAU;0BAEX,cAAA,6LAAC,gIAAA,CAAA,UAAK;oBAAC,KAAK;oBAAgB,OAAO;oBAAI,QAAQ;oBAAI,KAAI;oBAAG,SAAS;oBAAc,WAAU;;;;;;;;;;;;;;;;;AAa3G;GAtFM;;QAEe,qIAAA,CAAA,cAAW;;;KAF1B;uCAwFS","debugId":null}},
    {"offset": {"line": 141, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ramia/Documents/Projekty/PokedexNextJs/my-app/src/app/upload/page.tsx"],"sourcesContent":["\"use client\";\nimport { redirect, useRouter } from 'next/navigation';\nimport { useState, useEffect, useRef } from \"react\";\nimport axios from \"axios\";\nimport { Card } from \"@heroui/react\";\nimport { PokemonDetection } from \"@/types/history\";\nimport Camera from \"@/components/Camera/Camera\";\nimport Image from \"next/image\";\nimport { usePathname } from \"next/navigation\";\n\nexport default function ImageUploader() {\n    const [image, setImage] = useState<File | null>(null);\n    const [error, setError] = useState(\"\");\n    const [DetectedPokemonId, setDetectedPokemonId] = useState<number>()\n    const [loading, setLoading] = useState(false);\n    const router = useRouter();\n\n    const pathname = usePathname();\n\n    const handleUpload = async () => {\n        if (!image) {\n            return\n        }\n        setError(\"\")\n        setLoading(true);\n        const formData = new FormData();\n        formData.append(\"image\", image);\n        try {\n            const res = await axios.post<PokemonDetection & { id: number }>(\"/api/analyze\", formData, {\n                headers: {\n                    \"Content-Type\": \"multipart/form-data\",\n                },\n            });\n            console.log('res.data:', res.data)\n            setImage(null)\n            setDetectedPokemonId(res.data.id);\n        } catch (error: any) {\n            console.log(\"Error uploading image:\", error);\n            setError(error?.response?.data || \"Some error occured\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    if (pathname.includes(\"/upload\") && !loading && image && !error) {\n        handleUpload()\n    }\n    useEffect(() => {\n        if (!loading && image) {\n            handleUpload()\n        }\n    }, [image]);\n    useEffect(() => {\n        if (DetectedPokemonId !== undefined) {\n            router.push(`/pokemons/${DetectedPokemonId}`);\n        }\n    }, [DetectedPokemonId]);\n\n    return (\n        <>\n            <Card className=\"max-w-lg mx-auto p-4 space-y-4 bg-white shadow-lg rounded-none h-screen     z-auto  bg-[url('/camera-bg.jpg')] bg-cover bg-no-repeat\">\n                <Image src={'/header.png'} width={50} height={50} alt=\"\" className=\"absolute left-[0] top-[0] w-full\" unoptimized />\n\n\n                <div className=\"absolute  overflow-hidden inset-0 flex items-center h-auto justify-center z-[1]\">\n                    <Image\n                        src={'/captureNoBGbetter.png'}\n                        width={250}\n                        height={250}\n                        alt=\"Image Description\"\n                        className=\"w-[325px] opacity-80 z-30 drop-shadow-2xl\"\n                    />\n\n\n                    <Camera error={error} setImage={(image) => {\n                        setImage(image);\n\n                    }} />\n                    {error && <p className='absolute' style={{ zIndex: 5, color: \"red\" }}>{error}</p>}\n                </div>\n\n\n                <div\n                    className=\"w-full p-[6px] my-[0] absolute left-[0] bottom-[0]   h-[5rem]   flex justify-center  bg-violet-500\"\n\n                >\n                </div>\n\n\n                {loading && (<p style={{ zIndex: 5 }}>Loading</p>)}\n            </Card >\n        </>\n    );\n}"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;AAEA;AACA;;;AAPA;;;;;;;;AAUe,SAAS;;IACpB,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAe;IAChD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD;IACzD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IAEvB,MAAM,WAAW,CAAA,GAAA,qIAAA,CAAA,cAAW,AAAD;IAE3B,MAAM,eAAe;QACjB,IAAI,CAAC,OAAO;YACR;QACJ;QACA,SAAS;QACT,WAAW;QACX,MAAM,WAAW,IAAI;QACrB,SAAS,MAAM,CAAC,SAAS;QACzB,IAAI;YACA,MAAM,MAAM,MAAM,wIAAA,CAAA,UAAK,CAAC,IAAI,CAAoC,gBAAgB,UAAU;gBACtF,SAAS;oBACL,gBAAgB;gBACpB;YACJ;YACA,QAAQ,GAAG,CAAC,aAAa,IAAI,IAAI;YACjC,SAAS;YACT,qBAAqB,IAAI,IAAI,CAAC,EAAE;QACpC,EAAE,OAAO,OAAY;YACjB,QAAQ,GAAG,CAAC,0BAA0B;YACtC,SAAS,OAAO,UAAU,QAAQ;QACtC,SAAU;YACN,WAAW;QACf;IACJ;IAEA,IAAI,SAAS,QAAQ,CAAC,cAAc,CAAC,WAAW,SAAS,CAAC,OAAO;QAC7D;IACJ;IACA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;mCAAE;YACN,IAAI,CAAC,WAAW,OAAO;gBACnB;YACJ;QACJ;kCAAG;QAAC;KAAM;IACV,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;mCAAE;YACN,IAAI,sBAAsB,WAAW;gBACjC,OAAO,IAAI,CAAC,CAAC,UAAU,EAAE,mBAAmB;YAChD;QACJ;kCAAG;QAAC;KAAkB;IAEtB,qBACI;kBACI,cAAA,6LAAC,8OAAA,CAAA,OAAI;YAAC,WAAU;;8BACZ,6LAAC,gIAAA,CAAA,UAAK;oBAAC,KAAK;oBAAe,OAAO;oBAAI,QAAQ;oBAAI,KAAI;oBAAG,WAAU;oBAAmC,WAAW;;;;;;8BAGjH,6LAAC;oBAAI,WAAU;;sCACX,6LAAC,gIAAA,CAAA,UAAK;4BACF,KAAK;4BACL,OAAO;4BACP,QAAQ;4BACR,KAAI;4BACJ,WAAU;;;;;;sCAId,6LAAC,yIAAA,CAAA,UAAM;4BAAC,OAAO;4BAAO,UAAU,CAAC;gCAC7B,SAAS;4BAEb;;;;;;wBACC,uBAAS,6LAAC;4BAAE,WAAU;4BAAW,OAAO;gCAAE,QAAQ;gCAAG,OAAO;4BAAM;sCAAI;;;;;;;;;;;;8BAI3E,6LAAC;oBACG,WAAU;;;;;;gBAMb,yBAAY,6LAAC;oBAAE,OAAO;wBAAE,QAAQ;oBAAE;8BAAG;;;;;;;;;;;;;AAItD;GAnFwB;;QAKL,qIAAA,CAAA,YAAS;QAEP,qIAAA,CAAA,cAAW;;;KAPR","debugId":null}}]
}